"use strict";(self.webpackChunkaidforge_frontend=self.webpackChunkaidforge_frontend||[]).push([[607],{4254:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(1601),l=n.n(r),a=n(6314),c=n.n(a)()(l());c.push([e.id,".aid-received-page {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n  }\n  \n  .aid-received-page h1 {\n    color: #2c3e50;\n    margin-bottom: 0.5rem;\n    font-size: 2.5rem;\n  }\n  \n  .aid-received-description {\n    color: #7f8c8d;\n    font-size: 1.1rem;\n    margin-bottom: 2rem;\n  }\n  \n  .aid-records-list {\n    background-color: #fff;\n    border-radius: 8px;\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n    padding: 1.5rem;\n  }\n  \n  .aid-records-list h2 {\n    color: #2c3e50;\n    margin-bottom: 1.5rem;\n    font-size: 1.8rem;\n  }\n  \n  .aid-table {\n    width: 100%;\n    border-collapse: collapse;\n  }\n  \n  .aid-table th,\n  .aid-table td {\n    padding: 0.75rem;\n    text-align: left;\n    border-bottom: 1px solid #ddd;\n  }\n  \n  .aid-table th {\n    background-color: #f8f9fa;\n    font-weight: 600;\n  }\n  \n  .status-delivered {\n    background-color: rgba(46, 204, 113, 0.1);\n  }\n  \n  .status-in-transit {\n    background-color: rgba(241, 196, 15, 0.1);\n  }\n  \n  .status-pending {\n    background-color: rgba(231, 76, 60, 0.1);\n  }\n  \n  .loading,\n  .error,\n  .no-records {\n    text-align: center;\n    padding: 2rem;\n  }\n  \n  .error {\n    color: #e74c3c;\n  }\n  \n  .no-records {\n    color: #7f8c8d;\n    font-style: italic;\n  }\n  ",""]);const o=c},4607:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var r=n(6540),l=n(7767),a=n(6852),c=n(4801),o=n(3840),i=n(9146),d=n(1342),s=n(7234),m=n(1052),u=n(9290),E=n(551),g=n(5353),b=n(3411),p=n(2280),f=n(913),h=n(4812),v=n(5773),y=n(2709),D=n(3738),A=n(208),x=n(5958),T=n(9378),w=n(3246),k=n(5800),C=n(548),S=n(7998),I=n(1994),P=n(9546),W=n(954),z=n(1904),L=n(8873),N=n(5072),Q=n.n(N),Z=n(7825),R=n.n(Z),V=n(7659),$=n.n(V),H=n(5056),U=n.n(H),j=n(540),F=n.n(j),_=n(1113),B=n.n(_),M=n(4254),O={};O.styleTagTransform=B(),O.setAttributes=U(),O.insert=$().bind(null,"head"),O.domAPI=R(),O.insertStyleElement=F(),Q()(M.A,O),M.A&&M.A.locals&&M.A.locals;const X=()=>{const{isAuthenticated:e,user:t,walletAddress:n,connectWallet:N}=(0,r.useContext)(a.cy),[Q,Z]=(0,r.useState)([]),[R,V]=(0,r.useState)(!0),[$,H]=(0,r.useState)(null),[U,j]=(0,r.useState)({totalAid:0,pendingAid:0,completedDeliveries:0,lastDeliveryDate:null}),F=(0,o.dU)("white","gray.800"),_=(0,o.dU)("gray.200","gray.700");return(0,r.useEffect)((()=>{let r=!0;return e&&"refugee"===t?.role&&(async()=>{try{V(!0);const e=await c.jb.getEnhancedAidRecords();if(r&&e?.data?.success){if(console.log("User wallet address:",n),console.log("All records:",e.data.records),!n)return console.warn("No wallet address found. Please connect your wallet."),void H("Please connect your wallet to view aid records.");const t=e.data.records.filter((e=>{const t=e.recipient?.toLowerCase(),r=n?.toLowerCase(),l=t===r;return console.log(`Record ${e.id}: ${t} === ${r} = ${l}`),l}));console.log("Filtered records:",t),Z(t);const r=t.reduce(((e,t)=>{e.totalAid+=Number(t.amount||0),"Pending"!==t.status&&"In Transit"!==t.status||(e.pendingAid+=Number(t.amount||0)),"Delivered"!==t.status&&"Verified"!==t.status||e.completedDeliveries++;const n=new Date(t.timestamp);return(!e.lastDeliveryDate||n>e.lastDeliveryDate)&&(e.lastDeliveryDate=n),e}),{totalAid:0,pendingAid:0,completedDeliveries:0,lastDeliveryDate:null});j(r),H(null)}}catch(e){console.error("Error fetching aid records:",e),r&&H("Failed to load aid records. Please try again later.")}finally{r&&V(!1)}})(),()=>{r=!1}}),[e,t,n]),e?"refugee"!==t?.role?r.createElement(l.C5,{to:"/dashboard"}):r.createElement(u.m,{maxW:"container.xl",py:8},r.createElement(E.T,{spacing:8,align:"stretch"},r.createElement(i.a,{textAlign:"center",mb:8},r.createElement(g.D,{size:"xl"},"Aid Received Dashboard"),r.createElement(m.E,{mt:2,color:"gray.600"},"Track and manage your received aid packages")),r.createElement(b.r,{columns:{base:1,md:4},spacing:6},r.createElement(p.Z,{bg:F,borderWidth:"1px",borderColor:_},r.createElement(f.b,null,r.createElement(h.r,null,r.createElement(v.v,null,"Total Aid Received"),r.createElement(y.k,null,r.createElement(s.s,{align:"center"},r.createElement(D.I,{as:z.liQ,mr:2}),(0,L.Q9)(U.totalAid)," ETH")),r.createElement(A.h,null,"Lifetime total")))),r.createElement(p.Z,{bg:F,borderWidth:"1px",borderColor:_},r.createElement(f.b,null,r.createElement(h.r,null,r.createElement(v.v,null,"Pending Aid"),r.createElement(y.k,null,r.createElement(s.s,{align:"center"},r.createElement(D.I,{as:z.liQ,mr:2}),(0,L.Q9)(U.pendingAid)," ETH")),r.createElement(A.h,null,"In process")))),r.createElement(p.Z,{bg:F,borderWidth:"1px",borderColor:_},r.createElement(f.b,null,r.createElement(h.r,null,r.createElement(v.v,null,"Completed Deliveries"),r.createElement(y.k,null,r.createElement(s.s,{align:"center"},r.createElement(D.I,{as:z.rrY,mr:2}),U.completedDeliveries)),r.createElement(A.h,null,"Successfully received")))),r.createElement(p.Z,{bg:F,borderWidth:"1px",borderColor:_},r.createElement(f.b,null,r.createElement(h.r,null,r.createElement(v.v,null,"Last Delivery"),r.createElement(y.k,null,r.createElement(s.s,{align:"center"},r.createElement(D.I,{as:z.bfZ,mr:2}),U.lastDeliveryDate?new Date(U.lastDeliveryDate).toLocaleDateString():"N/A")),r.createElement(A.h,null,"Most recent aid"))))),r.createElement(p.Z,{bg:F,borderWidth:"1px",borderColor:_},r.createElement(f.b,null,r.createElement(x.B,{spacing:6},r.createElement(g.D,{size:"md"},"Aid History"),r.createElement(T.c,null),R?r.createElement(m.E,{textAlign:"center"},"Loading aid records..."):$?r.createElement(m.E,{textAlign:"center",color:"red.500"},$):0===Q.length?r.createElement(m.E,{textAlign:"center"},"No aid records found."):r.createElement(w.X,{variant:"simple"},r.createElement(k.d,null,r.createElement(C.Tr,null,r.createElement(S.Th,null,"Date"),r.createElement(S.Th,null,"Type"),r.createElement(S.Th,null,"Amount"),r.createElement(S.Th,null,"Status"),r.createElement(S.Th,null,"Progress"))),r.createElement(I.N,null,Q.map((e=>r.createElement(C.Tr,{key:e.id},r.createElement(P.Td,null,(0,L.x5)(e.timestamp)),r.createElement(P.Td,null,e.aidType),r.createElement(P.Td,null,r.createElement(s.s,{align:"center"},r.createElement(D.I,{as:z.liQ,mr:1}),(0,L.Q9)(e.amount))),r.createElement(P.Td,null,r.createElement(W.E,{colorScheme:"Verified"===e.status?"green":"Delivered"===e.status?"blue":"In Transit"===e.status?"yellow":"gray"},e.status)),r.createElement(P.Td,{width:"300px"},(e=>{const t=["Pending","In Transit","Delivered","Verified"],n=t.indexOf(e),l=(n+1)/t.length*100;return r.createElement(i.a,null,r.createElement(d.k,{value:l,size:"sm",colorScheme:"Verified"===e?"green":"Delivered"===e?"blue":"yellow",mb:2}),r.createElement(s.s,{justify:"space-between"},t.map(((e,t)=>r.createElement(m.E,{key:e,fontSize:"xs",color:t<=n?"green.500":"gray.500",fontWeight:t===n?"bold":"normal"},e)))))})(e.status)))))))))))):r.createElement(l.C5,{to:"/login"})}}}]);