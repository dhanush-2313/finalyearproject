"use strict";(self.webpackChunkaidforge_frontend=self.webpackChunkaidforge_frontend||[]).push([[218],{7218:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var n=a(6540),r=a(2468),l=a(3840),c=a(9290),o=a(9146),i=a(5353),s=a(1052),u=a(3812),d=a(1082),m=a(7069),E=a(63),h=a(6808),g=a(9378),p=a(7767),b=a(6852),y=a(9637),f=a(551),C=a(4466),w=a(6944),S=a(1175),k=a(3034),v=a(4044),F=a(3609),x=a(7205),A=a(5444),R=a(1194),T=a(5323),z=a(7584),D=a(6277),M=a(1570),$=a(714),W=a(8263),_=a(6954),P=a(5828),L=a(8575);const B=e=>{let{isEnabled:t=!1,onStatusChange:a}=e;const[l,c]=(0,n.useState)("initial"),[i,u]=(0,n.useState)(""),[d,m]=(0,n.useState)(""),[E,h]=(0,n.useState)(""),[g,p]=(0,n.useState)([]),[b,B]=(0,n.useState)(""),[N,O]=(0,n.useState)(!1),{isOpen:U,onOpen:G,onClose:J}=(0,y.j)(),K=(0,r.d)();return"initial"===l?n.createElement(o.a,{p:6,borderWidth:"1px",borderRadius:"lg",width:"100%"},n.createElement(f.T,{spacing:4,align:"stretch"},n.createElement(s.E,{fontSize:"xl",fontWeight:"bold"},"Two-Factor Authentication (2FA)"),n.createElement(s.E,null,"Add an extra layer of security to your account by requiring a verification code in addition to your password when signing in."),b&&n.createElement(C.F,{status:"error",borderRadius:"md"},n.createElement(w._,null),b),t?n.createElement(f.T,{spacing:4},n.createElement(C.F,{status:"success",borderRadius:"md"},n.createElement(w._,null),n.createElement(S.X,null,"2FA is enabled for your account")),n.createElement(k.$,{colorScheme:"red",width:"100%",onClick:G,isLoading:N},"Disable 2FA"),n.createElement(k.$,{colorScheme:"blue",variant:"outline",width:"100%",onClick:()=>c("regenerate")},"Regenerate Backup Codes")):n.createElement(k.$,{colorScheme:"blue",width:"100%",onClick:async()=>{B(""),O(!0);try{const e=await(0,L.uG)();u(e.qrCode),m(e.mfaSecret),c("setup")}catch(e){B(e.response?.data?.error||"Failed to setup MFA")}finally{O(!1)}},isLoading:N},"Setup Two-Factor Authentication")),n.createElement(v.aF,{isOpen:U,onClose:J},n.createElement(F.m,null),n.createElement(x.$,null,n.createElement(A.r,null,"Disable Two-Factor Authentication"),n.createElement(R.s,null),n.createElement(T.c,null,n.createElement(f.T,{spacing:4},n.createElement(s.E,null,"Please enter your 2FA code to confirm disabling two-factor authentication for your account."),n.createElement(z.MJ,null,n.createElement(D.l,null,"Verification Code"),n.createElement(M.p,{type:"text",placeholder:"Enter 6-digit code",value:E,onChange:e=>h(e.target.value.trim()),maxLength:6})),b&&n.createElement(C.F,{status:"error",borderRadius:"md"},n.createElement(w._,null),b))),n.createElement($.j,null,n.createElement(k.$,{variant:"ghost",mr:3,onClick:J},"Cancel"),n.createElement(k.$,{colorScheme:"red",onClick:async()=>{B(""),O(!0);try{if(!E)return B("Please enter your verification code"),void O(!1);await(0,L.RR)(E),h(""),c("initial"),a(!1),K({title:"MFA Disabled",description:"Two-factor authentication has been disabled for your account.",status:"info",duration:5e3,isClosable:!0})}catch(e){B(e.response?.data?.error||"Failed to disable MFA")}finally{O(!1),J()}},isLoading:N},"Disable 2FA"))))):"setup"===l?n.createElement(o.a,{p:6,borderWidth:"1px",borderRadius:"lg",width:"100%"},n.createElement(f.T,{spacing:4,align:"stretch"},n.createElement(s.E,{fontSize:"xl",fontWeight:"bold"},"Setup Two-Factor Authentication"),n.createElement(s.E,null,"1. Scan this QR code with your authenticator app (like Google Authenticator, Authy, or Microsoft Authenticator)"),n.createElement(o.a,{bg:"white",p:4,alignSelf:"center"},i&&n.createElement(W._,{src:i,alt:"QR Code",boxSize:"200px"})),n.createElement(s.E,null,"2. Or manually enter this secret key in your app:"),n.createElement(_.C,{p:2,borderRadius:"md",fontSize:"md",textAlign:"center"},d),n.createElement(s.E,{mt:2},"3. Enter the verification code shown in your app:"),b&&n.createElement(C.F,{status:"error",borderRadius:"md"},n.createElement(w._,null),b),n.createElement(z.MJ,null,n.createElement(M.p,{type:"text",placeholder:"Enter 6-digit code",value:E,onChange:e=>h(e.target.value.trim()),maxLength:6})),n.createElement(k.$,{colorScheme:"blue",onClick:async()=>{B(""),O(!0);try{if(!E)return B("Please enter your verification code"),void O(!1);const e=await(0,L.um)(E);p(e.backupCodes),c("success"),a(!0)}catch(e){B(e.response?.data?.error||"Failed to verify code")}finally{O(!1)}},isLoading:N,mt:2},"Verify and Enable"),n.createElement(k.$,{variant:"ghost",onClick:()=>c("initial")},"Cancel"))):"success"===l?n.createElement(o.a,{p:6,borderWidth:"1px",borderRadius:"lg",width:"100%"},n.createElement(f.T,{spacing:4,align:"stretch"},n.createElement(C.F,{status:"success",borderRadius:"md"},n.createElement(w._,null),n.createElement(S.X,null,"Two-factor authentication is now enabled!")),n.createElement(s.E,{fontSize:"lg",fontWeight:"bold"},"Backup Codes"),n.createElement(s.E,null,"Save these backup codes in a secure place. If you lose your phone or can't access your authenticator app, you can use one of these one-time codes to sign in."),n.createElement(P.x,{templateColumns:"repeat(2, 1fr)",gap:4},g.map(((e,t)=>n.createElement(_.C,{key:t,p:2,borderRadius:"md",textAlign:"center"},e)))),n.createElement(C.F,{status:"warning",borderRadius:"md"},n.createElement(w._,null),"Each code can only be used once, and they're the only way to access your account if you lose your authenticator device."),n.createElement(k.$,{colorScheme:"blue",onClick:()=>c("initial"),mt:2},"Done"))):"regenerate"===l?n.createElement(o.a,{p:6,borderWidth:"1px",borderRadius:"lg",width:"100%"},n.createElement(f.T,{spacing:4,align:"stretch"},n.createElement(s.E,{fontSize:"xl",fontWeight:"bold"},"Regenerate Backup Codes"),n.createElement(s.E,null,"Enter your 2FA code to generate new backup codes. This will invalidate all existing backup codes."),b&&n.createElement(C.F,{status:"error",borderRadius:"md"},n.createElement(w._,null),b),n.createElement(z.MJ,null,n.createElement(D.l,null,"Verification Code"),n.createElement(M.p,{type:"text",placeholder:"Enter 6-digit code",value:E,onChange:e=>h(e.target.value.trim()),maxLength:6})),n.createElement(k.$,{colorScheme:"blue",onClick:async()=>{B(""),O(!0);try{if(!E)return B("Please enter your verification code"),void O(!1);const e=await(0,L.BM)(E);p(e.backupCodes),c("success"),K({title:"Backup Codes Regenerated",description:"New backup codes have been generated. Save them in a secure place.",status:"success",duration:5e3,isClosable:!0})}catch(e){B(e.response?.data?.error||"Failed to regenerate backup codes")}finally{O(!1)}},isLoading:N},"Generate New Backup Codes"),n.createElement(k.$,{variant:"ghost",onClick:()=>c("initial")},"Cancel"))):void 0},N=()=>{const{isAuthenticated:e,user:t}=(0,n.useContext)(b.cy),[a,y]=(0,n.useState)(0),f=(0,r.d)(),C=(0,l.dU)("white","gray.800"),w=(0,l.dU)("gray.200","gray.700");return e?n.createElement(c.m,{maxW:"container.lg",py:8},n.createElement(o.a,{mb:8},n.createElement(i.D,{size:"lg",mb:2},"Account Settings"),n.createElement(s.E,{color:(0,l.dU)("gray.600","gray.400")},"Manage your account preferences and security settings")),n.createElement(o.a,{bg:C,borderRadius:"lg",borderWidth:"1px",borderColor:w,overflow:"hidden"},n.createElement(u.t,{index:a,onChange:e=>y(e)},n.createElement(d.w,{px:4,bg:(0,l.dU)("gray.50","gray.900")},n.createElement(m.o,null,"Profile"),n.createElement(m.o,null,"Security"),n.createElement(m.o,null,"Notifications")),n.createElement(E.T,null,n.createElement(h.K,null,n.createElement(o.a,null,n.createElement(i.D,{size:"md",mb:4},"Profile Information"),n.createElement(s.E,null,"Name: ",t?.name),n.createElement(s.E,null,"Email: ",t?.email),n.createElement(s.E,null,"Role: ",t?.role))),n.createElement(h.K,null,n.createElement(o.a,null,n.createElement(i.D,{size:"md",mb:4},"Security Settings"),n.createElement(o.a,{my:6},n.createElement(B,{isEnabled:t?.mfaEnabled||!1,onStatusChange:e=>{f({title:e?"MFA Enabled":"MFA Disabled",description:e?"Two-factor authentication has been enabled for your account.":"Two-factor authentication has been disabled for your account.",status:e?"success":"info",duration:5e3,isClosable:!0})}})),n.createElement(g.c,{my:6}),n.createElement(o.a,null,n.createElement(i.D,{size:"md",mb:4},"Change Password"),n.createElement(s.E,null,"Password change functionality coming soon.")))),n.createElement(h.K,null,n.createElement(i.D,{size:"md",mb:4},"Notification Preferences"),n.createElement(s.E,null,"Notification settings coming soon.")))))):n.createElement(p.C5,{to:"/login"})}}}]);