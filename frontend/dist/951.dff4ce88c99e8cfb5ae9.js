"use strict";(self.webpackChunkaidforge_frontend=self.webpackChunkaidforge_frontend||[]).push([[951],{1094:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(1601),r=n.n(a),l=n(6314),o=n.n(l)()(r());o.push([e.id,'.connect-wallet {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: auto;\n}\n\n.connect-wallet button {\n  background: linear-gradient(135deg, #007bff, #0056b3);\n  border: none;\n  color: white;\n  padding: 12px 24px;\n  font-size: 16px;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: background 0.3s ease, transform 0.3s ease;\n  font-family: "Poppins", sans-serif;\n}\n\n.connect-wallet button:hover {\n  background: linear-gradient(135deg, #0056b3, #003d80);\n  transform: translateY(-2px);\n}\n\n.connect-wallet button:active {\n  transform: translateY(0);\n}\n\n.connect-wallet p {\n  font-size: 16px;\n  font-weight: bold;\n  color: #333;\n}\n\n',""]);const i=o},9951:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var a=n(6540),r=n(3840),l=n(9146),o=n(7234),i=n(3738),c=n(4812),s=n(5773),d=n(2709),u=n(208),m=n(2468),g=n(9290),b=n(5958),E=n(5353),p=n(3034),f=n(717),h=n(1052),y=n(3411),w=n(5828),A=n(0),v=n(1904),x=n(2273),C=n(5226),S=n(1698),k=n(5072),R=n.n(k),P=n(7825),W=n.n(P),j=n(7659),T=n.n(j),z=n(5056),I=n.n(z),U=n(540),D=n.n(U),B=n(1113),M=n.n(B),H=n(1094),$={};$.styleTagTransform=M(),$.setAttributes=I(),$.insert=T().bind(null,"head"),$.domAPI=W(),$.insertStyleElement=D(),R()(H.A,$),H.A&&H.A.locals&&H.A.locals;const F=e=>{let{account:t,connectWallet:n}=e;const[r,l]=(0,a.useState)(!1);return a.createElement("div",{className:"connect-wallet"},t?a.createElement("p",null,"✅ Connected: ",t.substring(0,6),"...",t.substring(t.length-4)):a.createElement("button",{onClick:async()=>{if(window.ethereum)if(r||t)console.warn("⚠️ Already connecting or wallet is already connected.");else{l(!0);try{await n()}catch(e){console.error("❌ Wallet connection failed:",e),alert("Wallet connection failed. Please try again.")}l(!1)}else alert("MetaMask is not installed. Please install it and try again.")},disabled:r},r?"Connecting...":"Connect Wallet"))};var N=n(2392),Y=n(9632),_=n(4801),L=n(7767),Q=n(8873);const q=e=>{let{title:t,value:n,icon:m,helpText:g}=e;const b=(0,r.dU)("white","gray.800"),E=(0,r.dU)("gray.200","gray.700"),p=(0,r.dU)("blue.500","blue.200");return a.createElement(l.a,{p:6,bg:b,borderRadius:"lg",borderWidth:"1px",borderColor:E,shadow:"lg"},a.createElement(o.s,{alignItems:"center",mb:4},a.createElement(i.I,{as:m,w:8,h:8,color:p,mr:3}),a.createElement(c.r,null,a.createElement(s.v,{fontSize:"lg",fontWeight:"medium"},t),a.createElement(d.k,{fontSize:"3xl",fontWeight:"bold"},n),g&&a.createElement(u.h,{color:(0,r.dU)("gray.600","gray.400")},g))))},O=()=>{const e=(0,r.dU)("gray.50","gray.900"),{user:t}=(0,Y.A)(),n=(0,m.d)(),i=(0,L.Zp)(),[c,s]=(0,a.useState)(""),[d,u]=(0,a.useState)({totalAid:"0",beneficiaries:"0",activeProjects:"0",verifiedRecords:"0"}),[k,R]=(0,a.useState)(!0),[P,W]=(0,a.useState)([]),j=async e=>{R(!0);try{let e=[];try{const t=await _.jb.getEnhancedAidRecords();t?.data?.success&&(console.log("Enhanced API Response:",t.data),e=t.data.records||[])}catch(t){console.error("Enhanced aid records error:",t);const n=await _.jb.getAidRecords();console.log("Regular API Response:",n.data),n.data&&(e=Array.isArray(n.data.records)?n.data.records:Array.isArray(n.data)?n.data:[])}console.log("Processing records:",e);const t=e.reduce(((e,t)=>e+(Number(t.amount)||0)),0),n=new Set(e.map((e=>e.recipient)).filter(Boolean)).size,a=new Set(e.filter((e=>"active"===e.status)).map((e=>e.projectId)).filter(Boolean)).size,r=e.filter((e=>!0===e.verified)).length;u({totalAid:`${(0,Q.Q9)(t)} ETH`,beneficiaries:n.toString(),activeProjects:a.toString(),verifiedRecords:r.toString()});const l=e.sort(((e,t)=>new Date(t.timestamp||0)-new Date(e.timestamp||0))).slice(0,5);W(l)}catch(e){console.error("Error fetching blockchain data:",e),n({title:"Data Fetch Error",description:"Unable to fetch blockchain data. Please try again later.",status:"error",duration:3e3,isClosable:!0}),u({totalAid:"0 ETH",beneficiaries:"0",activeProjects:"0",verifiedRecords:"0"})}finally{R(!1)}};return(0,a.useEffect)((()=>{j()}),[]),a.createElement(l.a,{minH:"100vh",bg:e},a.createElement(g.m,{maxW:"container.xl",py:8},a.createElement(b.B,{spacing:8},a.createElement(o.s,{justifyContent:"space-between",alignItems:"center",mb:6},a.createElement(E.D,{size:"lg"},"Dashboard Overview"),a.createElement(o.s,{gap:4},a.createElement(F,{account:c,connectWallet:async()=>{if(window.ethereum)try{const e=await window.ethereum.request({method:"eth_requestAccounts"});s(e[0]),n({title:"Wallet Connected",description:`Connected to ${e[0].substring(0,6)}...${e[0].substring(e[0].length-4)}`,status:"success",duration:3e3,isClosable:!0}),j(e[0])}catch(e){console.error("Error connecting wallet:",e),n({title:"Connection Failed",description:"Failed to connect wallet. Please try again.",status:"error",duration:3e3,isClosable:!0})}else n({title:"MetaMask Not Found",description:"Please install MetaMask browser extension to connect your wallet.",status:"warning",duration:5e3,isClosable:!0})}}),a.createElement(p.$,{leftIcon:a.createElement(v.axc,null),colorScheme:"red",variant:"solid",onClick:async()=>{try{await _.R2.logout(),localStorage.removeItem("token"),n({title:"Logged out",description:"You have been successfully logged out.",status:"success",duration:3e3,isClosable:!0}),i("/login")}catch(e){n({title:"Error",description:"An error occurred while logging out.",status:"error",duration:3e3,isClosable:!0})}}},"Logout"))),a.createElement(S.A,null),k?a.createElement(o.s,{justify:"center",align:"center",my:10},a.createElement(f.P,{isIndeterminate:!0,color:"blue.500"}),a.createElement(h.E,{ml:4,fontSize:"lg"},"Loading blockchain data...")):a.createElement(y.r,{columns:{base:1,md:2,lg:4},spacing:6},a.createElement(q,{title:"Total Aid Distributed",value:d.totalAid,icon:v.liQ,helpText:"All time distribution"}),a.createElement(q,{title:"Total Beneficiaries",value:d.beneficiaries,icon:v.YXz,helpText:"Registered recipients"}),a.createElement(q,{title:"Active Projects",value:d.activeProjects,icon:v._oH,helpText:"Ongoing aid projects"}),a.createElement(q,{title:"Verified Records",value:d.verifiedRecords,icon:v.t69,helpText:"Blockchain verified"})),a.createElement(w.x,{templateColumns:{base:"repeat(1, 1fr)",lg:"repeat(3, 1fr)"},gap:8},a.createElement(A.E,{colSpan:{base:1,lg:1}},a.createElement(x.A,{isWalletConnected:!!c,wallet:c})),a.createElement(A.E,{colSpan:{base:1,lg:2}},a.createElement(l.a,{bg:(0,r.dU)("white","gray.800"),borderRadius:"lg",borderWidth:"1px",borderColor:(0,r.dU)("gray.200","gray.700"),shadow:"lg",p:6},a.createElement(E.D,{size:"md",mb:4},"Recent Activity"),P.length>0?a.createElement(b.B,{spacing:3},P.map(((e,t)=>a.createElement(l.a,{key:t,p:3,borderWidth:"1px",borderRadius:"md"},a.createElement(o.s,{justify:"space-between"},a.createElement(h.E,{fontWeight:"bold"},e.description||`Aid Record #${e.id}`),a.createElement(h.E,{fontSize:"sm",color:"gray.500"},(0,Q.x5)(e.timestamp))),a.createElement(h.E,{mt:1},"Status: ",e.status),a.createElement(h.E,null,"Amount: ",(0,Q.Q9)(e.amount)," ETH"),a.createElement(h.E,null,"Recipient: ",a.createElement(N.A,{address:e.recipient||e.recipientId})))))):a.createElement(h.E,{color:(0,r.dU)("gray.600","gray.400")},"No recent activities to display")))),a.createElement(l.a,null,a.createElement(C.A,{walletAddress:c})))))}}}]);